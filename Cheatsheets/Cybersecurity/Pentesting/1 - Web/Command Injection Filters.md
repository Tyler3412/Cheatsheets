Navigation: [[Pentesting]]

---
# Table of Contents
1. Blacklisted Characters
2. Blacklisted Commands
3. Command Obfuscation
# Blacklisted Characters
To identify blacklisted characters, we can send a request containing each character one by one on burp. Whatever returns an invalid input has been filtered.

Spaces are often one of the most filtered characters. Here's some things we can use to try and bypass it:
```shell
%09 # tabs instead of spaces
${IFS} # Linux env var for space
{ls, -la} # brace expansion
```

[`PayloadAllTheThings`](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#bypass-without-space) has a repository full of character bypasses.
# Blacklisted Commands
To bypass blacklisted commands, we can use:
- Character insertion: `'' or ""`, `\` on Bash, or `^` on Windows CMD only. These will be ignored by the system
- Case manipulation
- Reversed commands: `iex "$('imaohw'[-1..-20] -join '')"` or `$(rev<<<'imaohw')`
- Encoded commands: `iex "$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('dwBoAG8AYQBtAGkA')))"`

# Command Obfuscation
[Windows Command Obfuscator](https://github.com/danielbohannon/Invoke-DOSfuscation)
[Linux Command Obfuscator](https://github.com/Bashfuscator/Bashfuscator)

---
Navigation: [[Pentesting]]